<div class="card">
  {{#Furigana}}
    <div class="expression-wrapper">
      <h2 class="expression plain-expression">
        {{Expression}}
      </h2>
      <h2 class="expression furigana-expression is-hidden">
        {{Furigana}}
      </h2>
    </div>
  {{/Furigana}}
  {{^Furigana}}
    <h2 class="expression expression-no-furigana">
      {{Expression}}
    </h2>
    <p><strong>Reading:</strong> {{Reading}}</p>
  {{/Furigana}}

  {{#Sentence}}
  <hr>
  <div class="sentence-wrapper">
    <p class="sentence plain-sentence preline">
      {{Sentence}}
    </p>
    {{#SentenceFurigana}}
      <p class="sentence furigana-sentence preline is-hidden">
        {{SentenceFurigana}}
      </p>
    {{/SentenceFurigana}}
    {{^SentenceFurigana}}
      {{#SentenceKana}}
        <p class="sentence kana-sentence preline is-hidden">
          {{SentenceKana}}
        </p>
      {{/SentenceKana}}
    {{/SentenceFurigana}}
  </div>
  {{/Sentence}}

  {{#Furigana}}
    <div style="text-align: center; margin-top: 15px;">
      <button type="button" onclick="toggleFurigana()" title="Toggle furigana">Toggle Furigana</button>
    </div>
  {{/Furigana}}
  {{^Furigana}}
    {{#SentenceKana}}
      <div style="text-align: center; margin-top: 15px;">
        <button type="button" onclick="toggleFurigana()" title="Toggle kana">Toggle Kana</button>
      </div>
    {{/SentenceKana}}
  {{/Furigana}}
</div>

<script>
function toggleFurigana() {
  // Expression toggling
  const plainExpression = document.querySelector('.plain-expression');
  const furiganaExpression = document.querySelector('.furigana-expression');
  if (plainExpression && furiganaExpression) {
    if (furiganaExpression.classList.contains('is-hidden')) {
      furiganaExpression.classList.remove('is-hidden');
      plainExpression.classList.add('is-hidden');
    } else {
      furiganaExpression.classList.add('is-hidden');
      plainExpression.classList.remove('is-hidden');
    }
  }

  // Sentence toggling (Furigana vs. Kana)
  const plainSentence = document.querySelector('.plain-sentence');
  const furiganaSentence = document.querySelector('.furigana-sentence');
  const kanaSentence = document.querySelector('.kana-sentence');
  if (plainSentence) {
    if (furiganaSentence && furiganaSentence.classList.contains('is-hidden')) {
      furiganaSentence.classList.remove('is-hidden');
      plainSentence.classList.add('is-hidden');
      if (kanaSentence) kanaSentence.classList.add('is-hidden');
    } else if (furiganaSentence && !furiganaSentence.classList.contains('is-hidden')) {
      furiganaSentence.classList.add('is-hidden');
      plainSentence.classList.remove('is-hidden');
      if (kanaSentence) kanaSentence.classList.remove('is-hidden');
    } else if (!furiganaSentence && kanaSentence) {
      // Falls es KEIN Furigana gibt, nur Kana toggeln
      if (kanaSentence.classList.contains('is-hidden')) {
        kanaSentence.classList.remove('is-hidden');
        plainSentence.classList.add('is-hidden');
      } else {
        kanaSentence.classList.add('is-hidden');
        plainSentence.classList.remove('is-hidden');
      }
    }
  }
}
</script>
